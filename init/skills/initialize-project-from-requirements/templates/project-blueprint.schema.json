{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Project Blueprint",
  "type": "object",
  "additionalProperties": true,
  "required": [
    "version",
    "project",
    "repo"
  ],
  "properties": {
    "version": {
      "type": "integer",
      "minimum": 1
    },
    "project": {
      "type": "object",
      "required": [
        "name",
        "description"
      ],
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$"
        },
        "description": {
          "type": "string",
          "minLength": 5
        },
        "domain": {
          "type": "string"
        },
        "primaryUsers": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": true
    },
    "repo": {
      "type": "object",
      "required": [
        "layout"
      ],
      "properties": {
        "layout": {
          "type": "string",
          "enum": [
            "single",
            "monorepo"
          ]
        },
        "language": {
          "type": "string",
          "enum": [
            "typescript",
            "javascript",
            "python",
            "go",
            "java",
            "dotnet",
            "other"
          ]
        },
        "packageManager": {
          "type": "string",
          "enum": [
            "npm",
            "pnpm",
            "yarn",
            "pip",
            "poetry",
            "go",
            "maven",
            "gradle",
            "dotnet",
            "other"
          ]
        }
      },
      "additionalProperties": true
    },
    "capabilities": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "frontend": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "framework": {
              "type": "string"
            }
          },
          "additionalProperties": true
        },
        "backend": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "framework": {
              "type": "string"
            }
          },
          "additionalProperties": true
        },
        "api": {
          "type": "object",
          "properties": {
            "style": {
              "type": "string",
              "enum": [
                "rest",
                "graphql",
                "rpc",
                "none"
              ]
            },
            "auth": {
              "type": "string",
              "enum": [
                "none",
                "session",
                "jwt",
                "oauth2",
                "api-key",
                "other"
              ]
            }
          },
          "additionalProperties": true
        },
        "database": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "kind": {
              "type": "string",
              "enum": [
                "none",
                "postgres",
                "mysql",
                "sqlite",
                "mssql",
                "mongodb",
                "dynamodb",
                "other"
              ]
            },
            "orm": {
              "type": "string"
            },
            "migrationStrategy": {
              "type": "string"
            }
          },
          "additionalProperties": true
        },
        "bpmn": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "storage": {
              "type": "string",
              "enum": [
                "none",
                "docs",
                "bpmn-files"
              ]
            }
          },
          "additionalProperties": true
        }
      }
    },
    "quality": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "testing": {
          "type": "object",
          "additionalProperties": true
        },
        "ci": {
          "type": "object",
          "additionalProperties": true
        },
        "devops": {
          "type": "object",
          "additionalProperties": true,
          "description": "DevOps / operations preferences (may influence suggested packs/scaffold).",
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "containerize": {
              "type": "boolean",
              "description": "Prefer container-based packaging."
            },
            "packaging": {
              "type": "boolean",
              "description": "Need packaging pipeline/scaffold."
            },
            "deployment": {
              "type": "boolean",
              "description": "Need deployment pipeline/scaffold."
            }
          }
        }
      }
    },
    "skills": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "packs": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "workflows",
              "backend",
              "frontend",
              "standards",
              "scaffold",
              "context-core"
            ]
          },
          "description": "Skill packs to enable. 'context-core' and 'scaffold' are provided by context-awareness add-on."
        }
      }
    },
    "addons": {
      "type": "object",
      "description": "Optional add-ons toggles. Enable add-ons based on project needs.",
      "properties": {
        "contextAwareness": {
          "type": "boolean",
          "description": "Enable the context-awareness add-on (API/DB/BPMN contracts for LLM)."
        },
        "context-awareness": {
          "type": "boolean",
          "description": "Alias for contextAwareness."
        },
        "dbMirror": {
          "type": "boolean",
          "description": "Enable the db-mirror add-on (database schema mirroring and migrations)."
        },
        "db-mirror": {
          "type": "boolean",
          "description": "Alias for dbMirror."
        },
        "ciTemplates": {
          "type": "boolean",
          "description": "Enable the ci-templates add-on (CI/CD configuration templates)."
        },
        "ci-templates": {
          "type": "boolean",
          "description": "Alias for ciTemplates."
        },
        "packaging": {
          "type": "boolean",
          "description": "Enable the packaging add-on (container/artifact packaging)."
        },
        "deployment": {
          "type": "boolean",
          "description": "Enable the deployment add-on (multi-environment deployment)."
        },
        "release": {
          "type": "boolean",
          "description": "Enable the release add-on (version and changelog management)."
        },
        "observability": {
          "type": "boolean",
          "description": "Enable the observability add-on (metrics/logs/traces contracts)."
        }
      },
      "additionalProperties": true
    },
    "context": {
      "type": "object",
      "description": "Context management configuration (effective when context-awareness add-on is enabled).",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Context management config flag (does not install the add-on)."
        },
        "mode": {
          "type": "string",
          "enum": [
            "contract",
            "snapshot"
          ],
          "description": "Context collection mode."
        },
        "environments": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of environment names (e.g., dev, staging, prod)."
        }
      },
      "additionalProperties": true
    },
    "db": {
      "type": "object",
      "description": "Database configuration (effective when db-mirror add-on is enabled).",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "kind": {
          "type": "string",
          "enum": [
            "postgres",
            "mysql",
            "sqlite",
            "mssql",
            "mongodb",
            "other"
          ]
        },
        "environments": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Database environments (e.g., dev, staging, prod)."
        },
        "migrationTool": {
          "type": "string",
          "description": "Migration tool preference (e.g., prisma, knex, flyway)."
        }
      },
      "additionalProperties": true
    },
    "ci": {
      "type": "object",
      "description": "CI configuration (effective when ci-templates add-on is enabled).",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "platform": {
          "type": "string",
          "enum": [
            "github-actions",
            "gitlab-ci",
            "jenkins",
            "other"
          ],
          "description": "Primary CI platform."
        },
        "features": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "lint",
              "test",
              "build",
              "security",
              "release",
              "deploy"
            ]
          },
          "description": "CI features to enable."
        }
      },
      "additionalProperties": true
    },
    "packaging": {
      "type": "object",
      "description": "Packaging configuration (effective when packaging add-on is enabled).",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "containerize": {
          "type": "boolean",
          "description": "Use container-based packaging."
        },
        "targets": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "services",
              "jobs",
              "apps"
            ]
          },
          "description": "Types of artifacts to package."
        },
        "registry": {
          "type": "string",
          "description": "Container registry URL pattern."
        }
      },
      "additionalProperties": true
    },
    "deploy": {
      "type": "object",
      "description": "Deployment configuration (effective when deployment add-on is enabled).",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "model": {
          "type": "string",
          "enum": [
            "k8s",
            "serverless",
            "vm",
            "paas",
            "other"
          ],
          "description": "Deployment model."
        },
        "environments": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Deployment environments (e.g., dev, staging, prod)."
        },
        "k8s": {
          "type": "object",
          "description": "Kubernetes-specific configuration (when model is k8s).",
          "properties": {
            "tool": {
              "type": "string",
              "enum": [
                "helm",
                "kustomize",
                "manifests"
              ]
            },
            "namespaces": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    },
    "release": {
      "type": "object",
      "description": "Release configuration (effective when release add-on is enabled).",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "strategy": {
          "type": "string",
          "enum": [
            "semantic",
            "calendar",
            "manual"
          ],
          "description": "Versioning strategy."
        },
        "changelog": {
          "type": "boolean",
          "description": "Auto-generate changelog."
        },
        "branches": {
          "type": "object",
          "description": "Branch configuration for releases.",
          "properties": {
            "main": {
              "type": "string"
            },
            "develop": {
              "type": "string"
            }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    },
    "observability": {
      "type": "object",
      "description": "Observability configuration (effective when observability add-on is enabled).",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "metrics": {
          "type": "boolean",
          "description": "Enable metrics instrumentation contracts."
        },
        "logs": {
          "type": "boolean",
          "description": "Enable structured logging contracts."
        },
        "traces": {
          "type": "boolean",
          "description": "Enable distributed tracing contracts."
        },
        "platform": {
          "type": "string",
          "description": "Observability platform hint (e.g., prometheus, datadog, cloudwatch)."
        }
      },
      "additionalProperties": true
    },
    "devops": {
      "type": "object",
      "description": "Legacy DevOps scaffolding switches. Prefer using specific add-ons instead.",
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "packaging": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            }
          },
          "additionalProperties": true
        },
        "deploy": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean"
            }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    }
  }
}
